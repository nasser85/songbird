<html lang="en">
  <head>
    <title>Karaoke Songbird</title>
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
   <script src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
    <link href="style.css" rel="stylesheet">
  </head>
  <body>
  	<div id="searching"><img src="loading.gif"></img></div>
  	<div id="searchbar" class="searchbar">
	  	<h1>Karaoke Songbird</h1>
		<div class="input-group input-group-lg">
		  <input id="music-search" autofocus type="text" class="transparent form-control" placeholder="enter any part of an artist or song" aria-describedby="sizing-addon1">
		</div>
		<button id="send" type="button" class="btn btn-default btn-lg">
		  <span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
	</div>
	<div id="artist" class="row">
	  <div class="col-sm-8 col-sm-offset-2">
	    <div class="transparent thumbnail">
	      <img id="artist-pic" src="..." alt="...">
	      <div class="caption">
	        <h3 id="song-name">Song Title</h3>
	        <p id="artist-name">by Artist</p>
	        <p><a id="play" class="btn btn-primary" role="button">This is the Song</a> <a id="again" class="btn btn-default" role="button">Search Again</a></p>
	      </div>
	    </div>
	  </div>
	  <marquee id='lyrics' scrollamount="0" behavior="scroll" direction="left"></marquee>
	</div>
	<script>
		var song;
		var gamePlay;
		$("#send").click(function(){
			
			if ($('#music-search').val() !== '') {
				$('#searching').css('display', 'block');
				$('#searchbar').css('display', 'none')
	            $.ajax({
	                type: 'POST',
	                url: '/api',
	                data: { search: $('#music-search').val()},
	                success: function(output){
	                    if(output){ 
	                    	console.log(output)
	                    	song = output;
	                    	$('#searching').css('display', 'none');
	                    	$('#artist').css('display', 'block');
	                    	$('#song-name').html(song.title);
	                    	$('#artist-name').html('by ' + song.primary_artist.name);
	                    	$('#artist-pic').attr('src', song.song_art_image_thumbnail_url);
	                    	
	                        
	                    }else{
	                         return true; // this will redirect you to the action defined in your form tag, since no output was found.
	                    }
	                }
	            });
	        }

            return false;
        });
		$('#again').on('click', function() {
            $('#searchbar').css('display', 'block');
            $('#music-search').val('');
            $('#artist').css('display', 'none');
            clearInterval(gamePlay);
            $('body').css('background-image', 'url(background.jpg)').css('background-repeat', 'no-repeat').css('background-position', "0px, 0px");
            $('#artist-pic').css('width', '50%').css('margin-left', '25%')
            $('#play').css('display', 'inline-block');
            $('marquee').html('');
        })
        $('#play').on('click', function() {
        	$('body').css('background-image', 'url(stars.jpg)').css('background-repeat', 'repeat').css('background-position', "700px, 500px");
        	$('marquee').html(song.lyrics);
	        $('marquee').attr('scrollamount', '10');
	        $('#artist-pic').css('width', '20%').css('margin-left', '40%')
	        $('#play').css('display', 'none');
        	var begin= new Date().getTime();
            gamePlay = setInterval(function() {
                // if (spritePos < spriteArray.length) {
                //     spritePos ++;
                // } else {
                //     spritePos = 0;
                // }
                
                // d.style.backgroundPosition = spriteArray[spritePos];
                var x= Math.floor((new Date().getTime()-begin)/25);
                document.body.style.backgroundPosition = -x + 'px, 500px';
               
            }, 50);
        })
	</script>

  </body>
 </html>